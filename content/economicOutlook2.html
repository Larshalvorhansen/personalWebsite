<!DOCTYPE html>
<!--
The goal is for this website to display economic outlooks that I, Lars Halvor, have placed in a private spreadsheet online. A great CRM system if i can get it to work.
-->
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Economic Outlook</title>
    <link rel="manifest" href="/site.webmanifest">
    <script src="https://cdn.tailwindcss.com"></script>

<style>
    /* Make images behave nicely */
    .blog-post img {
        width: 100%;
        height: auto;
        object-fit: contain;
        max-height: 500px;
    }

    .main-content {
        padding: 1rem;
        max-width: 1000px; /* good readable width */
        margin: 0 auto; /* center horizontally */
    }

        .main-content {
            padding: 2rem; /* more breathing room on desktop */
        }

    @media (max-width: 767px) {
        .sidebar {
            width: 100%;
            height: auto;
            position: fixed;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: row;
            justify-content: space-around;
            padding: 1rem;
            background: #f0f0f0;
        }

        .main-content {
            margin-top: 80px; /* extra space to not hide behind sidebar */
        }
    }

    /* Fancy text gradient */
    .gradient-text {
        background: linear-gradient(45deg, #002896, #77cfff);
        background-clip: text;
        -webkit-background-clip: text;
        color: transparent;
        transition: background-position 0.3s ease-in-out;
        background-size: 200% 200%;
        background-position: 0% 50%;
    }

    .gradient-text:hover {
        background-position: 100% 50%;
    }
</style>
</head>

<body class=" text-white">
    <!-- Main Content -->
    <div class="main-content p-8 md:p-16">
        <img src="blogger'n.png" alt="Blogger'n" class="w-48 h-auto mb-8">
        <div id="posts-container" class="space-y-8"></div>
    </div>

<script>
    async function fetchBlogPosts() {
        try {
            const sheetId = '1cooW6kZlSKUgBjK4uPnv4cynbw3nM7NjwMjDHHFJ6mY';
            const apiKey = 'AIzaSyABuVJIWSJiUqk01nvpYF4QVzmgyZDCaGc';
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/EO2Response!A2:G?key=${apiKey}`;

            const response = await fetch(url);
            const data = await response.json();

            if (!data.values) throw new Error("Ingen data returnert fra Google Sheets.");

            const posts = data.values.reverse();
            const postsContainer = document.getElementById('posts-container');
            postsContainer.innerHTML = '';

            posts.forEach((post, index) => {
                const [timestamp, weekNum, status, prediction, imageUrl, sources, caption] = post;

                const postElement = document.createElement('div');
                postElement.classList.add('blog-post', 'text-black', 'shadow-lg', 'rounded-lg', 'p-6');

                const titleElement = document.createElement('h2');
                titleElement.textContent = `Week ${weekNum}`;
                titleElement.classList.add('text-2xl', 'font-bold', 'mb-2');

                const dateElement = document.createElement('small');
                dateElement.textContent = timestamp;
                dateElement.classList.add('text-sm', 'mb-4', 'block');

                const contentElement = document.createElement('p');
                contentElement.innerHTML = `<strong>Status:</strong> ${status}<br><strong>Prediction:</strong> ${prediction}`;
                contentElement.classList.add('mb-4');

                const imageElement = document.createElement('img');
                imageElement.src = imageUrl || `images/${index + 1}.jpg`;
                imageElement.alt = caption || '';
                imageElement.classList.add('w-full', 'max-h-64', 'object-cover', 'rounded-md', 'mb-2');

                const captionElement = document.createElement('p');
                captionElement.textContent = caption || '';
                captionElement.classList.add('text-sm', 'italic', 'mb-4');

                const sourcesElement = document.createElement('p');
                sourcesElement.innerHTML = `<strong>Sources:</strong><br>${sources.replace(/\n/g, '<br>')}`;
                sourcesElement.classList.add('text-xs');

                postElement.appendChild(titleElement);
                postElement.appendChild(dateElement);
                postElement.appendChild(contentElement);
                postElement.appendChild(imageElement);
                postElement.appendChild(captionElement);
                postElement.appendChild(sourcesElement);

                postsContainer.appendChild(postElement);
            });
        } catch (error) {
            console.error('Feil under henting av blogginnlegg:', error);
        }
    }

    window.onload = fetchBlogPosts;
</script>
</body>

</html>

