<!--
The goal is for this website to display economic outlooks that I, Lars Halvor, have placed in a private spreadsheet online. A great CRM system if i can get it to work.
-->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Economic Outλook</title>

  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="manifest" href="/site.webmanifest">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    * {
      font-family: 'Space Grotesk', sans-serif;
    }

    h1.title {
        font-family: 'Bentham', serif;
    }
  </style>
</head>

<body class="p-8 md:p-16 max-w-5xl mx-auto">

  <!-- Header -->
  <header class="mb-12">
<h1 class="title text-5xl md:text-7xl lg:text-9xl font-bold leading-tight tracking-tight uppercase">
  Economic Out
  <a href="https://halvorhansen.no/lambdasim"
     target="_blank"
     rel="noopener noreferrer"
     class="inline text-blue-500 lowercase align-baseline leading-none no-underline hover:text-blue-700"
     style="font-family: 'Bentham', serif; letter-spacing: -0.05em; margin-left: -0.1em; margin-right: -0.1em;">
    λ
  </a>
  ook
</h1>
    <p class="mt-4 text-lg md:text-2xl text-gray-700">
      A weekly status update and prediction of the future.
    </p>
    <p class="mt-2 text-sm md:text-lg text-gray-500">
      <b>In the beginning this will be quite brief, maybe bad and probably straight out factually wrong.</b><br>
      The point is for me to just get started and to improve over time.
    </p>
    <p class="mt-2 text-sm md:text-lg text-gray-500">
      <b>Since week 5 this site har been downprioritised. However I will pick this up again at week 19. Stay tuned!</b>
    </p>
  </header>

  <!-- Main Content -->
  <main>
    <div id="posts-container" class="divide-y divide-gray-300"></div>
  </main>

 <script>
  async function fetchBlogPosts() {
    try {
      const sheetId = '1cooW6kZlSKUgBjK4uPnv4cynbw3nM7NjwMjDHHFJ6mY';
      const apiKey = 'AIzaSyABuVJIWSJiUqk01nvpYF4QVzmgyZDCaGc';
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/EO2Response!A2:G?key=${apiKey}`;

      const response = await fetch(url);
      const data = await response.json();
      if (!data.values) throw new Error("Ingen data returnert fra Google Sheets.");

      const posts = data.values.reverse();
      const postsContainer = document.getElementById('posts-container');
      postsContainer.innerHTML = '';

      posts.forEach((post, index) => {
        const [timestamp, weekNum, status, prediction, imageUrl, sources, caption] = post;

        const postElement = document.createElement('div');
        postElement.className = 'py-8';

        // Linkify any URLs in the sources
        const linkedSources = sources.replace(/(https?:\/\/[^\s]+)/g, url =>
          `<a href="${url}" target="_blank" rel="noopener noreferrer" class="text-blue-500 underline">${url}</a>`
        ).replace(/\n/g, '<br>');

        postElement.innerHTML = `
          <h2 class="text-2xl font-bold mb-2">Week ${weekNum}</h2>
          <small class="text-sm mb-4 block">${timestamp}</small>
          <p class="mb-4"><strong>Status:</strong> ${status}<br><br><strong>Prediction:</strong> ${prediction}</p>
          <img src="${imageUrl || `images/${index + 1}.jpg`}" alt="${caption || ''}" class="w-full max-h-64 object-cover rounded-md mb-2">
          <p class="text-sm italic mb-4">${caption || ''}</p>
          <p class="text-xs"><strong>Sources:</strong><br>${linkedSources}</p>
        `;

        postsContainer.appendChild(postElement);
      });
    } catch (error) {
      console.error('Feil under henting av blogginnlegg:', error);
    }
  }

  window.onload = fetchBlogPosts;
</script>
</body>

</html>
